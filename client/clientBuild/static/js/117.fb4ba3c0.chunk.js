"use strict";(self.webpackChunkmodamia_app=self.webpackChunkmodamia_app||[]).push([[117],{1709:(t,n,e)=>{e.d(n,{Z:()=>i});var o=e(184);const i=()=>(0,o.jsx)("div",{className:"customization-body-loader",children:(0,o.jsx)("svg",{fill:"none",className:"customization-body-svg",viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg",children:(0,o.jsx)("circle",{className:"circle",cx:"50",cy:"50",r:"45"})})})},4504:(t,n,e)=>{e.d(n,{Z:()=>i});var o=e(184);const i=t=>{let{children:n}=t;return(0,o.jsx)("div",{className:"container",children:n})}},117:(t,n,e)=>{e.r(n),e.d(n,{default:()=>x});var o=e(4504),i=e(971),a=e(6037),l=e(2791),s=e(9434),c=e(7689),r=e(6100),d=e(5851),u=e(4437);const v=function(t,n){const[e,o]=(0,l.useState)(t);return(0,l.useEffect)((()=>{const e=setTimeout((()=>{o(t)}),n);return()=>{clearTimeout(e)}}),[t,n]),e};var h=e(1709),m=e(555),g=e(184);const f=t=>{let{data:n}=t;const e=(0,l.useRef)(null),[o,i]=(0,l.useState)(!1);return(0,l.useEffect)((()=>{n&&(async()=>{await(0,m.W$)(.3,n.modelData,"fronts",e,n.activeMannequin,n.modelData,!0,2.5),await i(!0)})()}),[n,e]),(0,l.useEffect)((()=>()=>{e.current=null}),[]),(0,g.jsxs)("div",{className:"customization-mannequin",children:[!o&&(0,g.jsx)(h.Z,{}),(0,g.jsx)("canvas",{...!o&&{style:{opacity:0,visibility:"hidden"}},ref:e})]})};var w=e(7098);const p=t=>{const[n,e]=(0,l.useState)(!1);if(t){const n=new Image;n.src=t,n.onload=()=>{e(!0)}}return n},I=t=>{let{name:n,url:e}=t;const o=p(e);return(0,g.jsx)("div",{className:"customization-mannequin",children:o?(0,g.jsx)("img",{src:e,alt:n}):(0,g.jsx)(h.Z,{})})},x=t=>{let{userId:n="",title:e=""}=t;const h=(0,s.I0)(),m=(0,l.useRef)(!1),p=(0,s.v9)(r.JN),x=(0,c.s0)();(0,l.useEffect)((()=>{(0,d.x6)(h,n)}),[n]);const[j,b]=(0,l.useState)(""),y=v(j,500);return(0,l.useEffect)((()=>{m.current?(async()=>{await(0,d.l3)(h,j,n)})():m.current=!0}),[y]),(0,g.jsx)("div",{className:"customization-mannequins",children:(0,g.jsxs)(o.Z,{children:[e&&(0,g.jsx)(i.Z,{size:"28px",align:"center",color:a.ue,text:e}),(0,g.jsxs)("div",{className:"customization-body customization-body-mannequins",children:[(0,g.jsx)(i.Z,{size:"22px",align:"center",...!e&&{color:a.ue},text:"Select garment to continue customization"}),(0,g.jsx)(u.Z,{classN:"customization-search",name:"search",callback:t=>{const{target:{value:n}}=t;if(null===j||void 0===j||!j.length)return b(n.trim());b(n)},value:j,placeholder:"Search Garment"}),!(null===p||void 0===p||!p.length)&&(0,g.jsx)("div",{className:"customization-mannequins-list",children:p.map(((t,n)=>{const{mannequin:e={},garment:o,_id:l="",details:s}=t;return(0,g.jsxs)("div",{className:"customization-elem",onClick:()=>((t,n)=>{n&&null!==t&&void 0!==t&&t._id&&(h((0,r.DA)(t)),x("/customization/".concat(n)))})(o,l||(null===o||void 0===o?void 0:o._id)),children:[(0,g.jsx)(i.Z,{text:null===o||void 0===o?void 0:o.name,size:"16px",color:a.ue,align:"center"}),s?(0,g.jsx)(f,{data:s}):(0,g.jsx)(I,{url:"".concat(w.jV).concat(null===e||void 0===e?void 0:e.fronturl),name:null===e||void 0===e?void 0:e.name})]},n)}))})]})]})})}},5851:(t,n,e)=>{e.d(n,{Cg:()=>c,l3:()=>r,x6:()=>s});var o=e(5838),i=e(6100),a=e(9153),l=e(8587);const s=(t,n)=>{(0,l.dm)({user_id:n}).then((n=>{t((0,i.$V)(n))})).catch((t=>console.log(t)))},c=async(t,n)=>{(0,l.qs)({garment_id:n}).then((async n=>{const{details:e={},...l}=n;var s;(await t((0,i.DA)(l)),null!==e&&void 0!==e&&e.details&&Object.keys(null===e||void 0===e?void 0:e.details).length)&&(await t((0,a.zq)(null===e||void 0===e||null===(s=e.details)||void 0===s?void 0:s.modelData)),await t((0,a.dz)(e)),await t((0,o.ot)(null===e||void 0===e?void 0:e.details)),await t((0,a.co)(!1)));await t((0,a.co)(!1))})).catch((n=>{console.log(n),t((0,a.co)(!1))}))},r=(t,n,e)=>{(0,l.Q$)({criteria:n,user_id:e}).then((n=>{t((0,i.$V)(n))})).catch((t=>console.log(t)))}},555:(t,n,e)=>{e.d(n,{W$:()=>r});var o=e(7098),i=e(6037);const a=[];async function l(t,n,e,o,i,a){let l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;const s=t.src||i.src,c=t.color||i.color,r=t.position||i.position,d=t.order||i.order,u=a?t.width/5*l:t.width||i.width,v=a?t.height/5*l:t.height||i.height,h=t.id||i.id;if(!s)return;const m=new Image;return m.src=await async function(t,n,e,o){const i=new Image;i.src=t,i.crossOrigin="*",await new Promise((t=>{i.onload=t}));const a=document.createElement("canvas").getContext("2d");if(!a)return"";if(a.canvas.width=e,a.canvas.height=o,a.clearRect(0,0,e,o),a.drawImage(i,0,0,e,o),n){const t=a.getImageData(0,0,e,o),i=t.data;let l=parseInt(n.substring(1),16);if(3===n.substring(1).length){let t="";for(let e=0;e<3;e++)t+=n.substring(1)[e]+n.substring(1)[e];l=parseInt(t,16)}const s=(16711680&l)>>16,c=(65280&l)>>8,r=255&l;let d;for(let n=0;n<i.length;n+=4)d=(i[n]/255+i[n+1]/255+i[n+2]/255+i[n+3]/255)/4,i[n]=s*d,i[n+1]=c*d,i[n+2]=r*d;a.putImageData(t,0,0)}return a.canvas.toDataURL("image/png")}(s,c,n,e),await new Promise((t=>{m.onload=t})),{img:m,position:r,color:c,widthImg:u,heightImg:v,order:d,frontBack:o,id:h}}async function s(t,n,e,o,i,a,l,s,c){let r=arguments.length>9&&void 0!==arguments[9]?arguments[9]:1,d=arguments.length>10&&void 0!==arguments[10]&&arguments[10];if(!n)return e;const u=new Image;if(u.src=n,u.crossOrigin="*",await new Promise((t=>{u.onload=t})),!e)return e.drawImage(u,0,0,o,i);t||e.drawImage(u,0,"bottom"===l?i-c:0,s,c);const v=document.createElement("canvas").getContext("2d");if(!v)return e.drawImage(u,0,0,o,i);v.canvas.width=o,v.canvas.height=i,v.clearRect(0,0,o,i),v.drawImage(u,0,0,d?o/5*r:o,d?i/5*r:i);const h=v.getImageData(0,0,o,i).data;let m=new Image;m.src=t,m.crossOrigin="*",await new Promise((t=>{m.onload=t}));const g=document.createElement("canvas").getContext("2d");if(!g)return e.drawImage(u,0,0,o,i);g.canvas.width=o,g.canvas.height=i,g.globalAlpha=1,g.globalCompositeOperation="multiply",g.clearRect(0,0,o,i),g.drawImage(u,0,0,d?o/5*r:o,d?i/5*r:i);for(let I=0;I*m.width*a<o;I++)for(let t=0;t*i*a<i;t++)g.drawImage(m,0,0,m.width,m.height,I*o*a,t*i*a,o*a,i*a);const f=g.getImageData(0,0,o,i),w=f.data;for(let I=0;I<h.length;I+=4)w[I+3]=h[I+3];g.putImageData(f,0,0);const p=new Image;return p.src=g.canvas.toDataURL("image/png"),await new Promise((t=>p.onload=t)),e.drawImage(p,0,l.includes("bottom")?i-(d?c/5*r:c):0,s,c)}let c;const r=function(t,n){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"fronts",r=arguments.length>3?arguments[3]:void 0,d=arguments.length>4?arguments[4]:void 0,u=arguments.length>5?arguments[5]:void 0,v=arguments.length>6?arguments[6]:void 0,h=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1;if(!r.current||null===d||void 0===d||!d._id)return;const m=r.current;let g=null===m||void 0===m?void 0:m.getContext("2d");const f=new Image;f.src="fronts"===e?"".concat(o.jV).concat(null===d||void 0===d?void 0:d.fronturl):"backs"===e?"".concat(o.uW).concat(null===d||void 0===d?void 0:d.backurl):"".concat(o.jV).concat(null===d||void 0===d?void 0:d.fronturl),f.onload=async()=>{const o=v?d.width/5*h:d.width,m=v?d.height/5*h:d.height;if(null===r.current)return;r.current.width=o,r.current.height=m;const w=o/m;let p=o,I=o/w;I>m&&(I=m,p=m*w);const x=(o-p)/2*h,j=(m-I)/2*h;null===g||void 0===g||g.clearRect(0,0,o,m),null===g||void 0===g||g.drawImage(f,x,j,p,I);const b=a.findIndex((t=>"sleeves"===(null===t||void 0===t?void 0:t.frontBack)));!n.sleeves[0].src&&a.length>2&&a.splice(b,1);for(let r=0;r<n[e].length;r++)if("color"===n[e][r].activeCategory)c=await l(n[e][r],o,m,e,u[e][r],v,h),(0,i.HA)(c,a,e),"sleeves"===e&&(c=await l(n.fronts[r],o,m,"fronts",u.fronts[r],v,h),(0,i.HA)(c,a,e));else if("print"===n[e][r].activeCategory){var y,z,N,k,C,_,D,R,Z,q,U,E,A,S,O,P,V,$,H,L,B,W,T,F,G,J,M,Q,K,X,Y,tt,nt,et,ot,it;if(s(n[e][r].printImageURL,null!==(y=n[e])&&void 0!==y&&null!==(z=y[r])&&void 0!==z&&z.src?null===(N=n[e])||void 0===N||null===(k=N[r])||void 0===k?void 0:k.src:null===(C=u[e])||void 0===C||null===(_=C[r])||void 0===_?void 0:_.src,g,o,m,t,n[e][r].position?n[e][r].position:u[e][r].position,null!==(D=n[e])&&void 0!==D&&null!==(R=D[r])&&void 0!==R&&R.width?null===(Z=n[e])||void 0===Z||null===(q=Z[r])||void 0===q?void 0:q.width:null===(U=u[e])||void 0===U||null===(E=U[r])||void 0===E?void 0:E.width,null!==(A=n[e])&&void 0!==A&&null!==(S=A[r])&&void 0!==S&&S.height?null===(O=n[e])||void 0===O||null===(P=O[r])||void 0===P?void 0:P.height:null===(V=u[e])||void 0===V||null===($=V[r])||void 0===$?void 0:$.height,h,v),"sleeves"===e)s(n.fronts[r].printImageURL,null!==(H=n.fronts)&&void 0!==H&&null!==(L=H[r])&&void 0!==L&&L.src?null===(B=n.fronts)||void 0===B||null===(W=B[r])||void 0===W?void 0:W.src:null===(T=u.fronts)||void 0===T||null===(F=T[r])||void 0===F?void 0:F.src,g,o,m,t,n.fronts[r].position,null!==(G=n.fronts)&&void 0!==G&&null!==(J=G[r])&&void 0!==J&&J.width?null===(M=n.fronts)||void 0===M||null===(Q=M[r])||void 0===Q?void 0:Q.width:null===(K=u.fronts)||void 0===K||null===(X=K[r])||void 0===X?void 0:X.width,null!==(Y=n.fronts)&&void 0!==Y&&null!==(tt=Y[r])&&void 0!==tt&&tt.height?null===(nt=n.fronts)||void 0===nt||null===(et=nt[r])||void 0===et?void 0:et.height:null===(ot=u.fronts)||void 0===ot||null===(it=ot[r])||void 0===it?void 0:it.height,h,v)}else{var at,lt;if("sleeves"===e)c=await l(null===(lt=n.fronts)||void 0===lt?void 0:lt[r],o,m,"fronts",u.fronts[r],v,h),(0,i.HA)(c,a,"fronts");c=await l(null===(at=n[e])||void 0===at?void 0:at[r],o,m,e,u[e][r],v,h),(0,i.HA)(c,a,e)}await async function(t,n){const e=t.sort(((t,n)=>t.order-n.order));for(const o of e){const{img:t,position:e,widthImg:i,heightImg:a}=o;n.drawImage(t,0,e.includes("bottom")?n.canvas.height-a:0,i,a)}}(a,g)}}},4437:(t,n,e)=>{e.d(n,{Z:()=>i});var o=e(184);const i=t=>{let{value:n="",placeholder:e="",type:i="text",callback:a,label:l="",name:s,error:c,autoComplete:r="",classN:d="",disabled:u=!1,defaultChecked:v=!1}=t;return(0,o.jsxs)("div",{className:"InputUI ".concat(d),children:[l&&(0,o.jsx)("label",{className:"InputUI__label",htmlFor:"InputUI-".concat(s),children:l}),c&&(0,o.jsx)("span",{className:"error-message",children:c}),(0,o.jsx)("input",{className:"InputUI__input".concat(c?" _error":"").concat(u?" _disabled":""),id:"InputUI-".concat(s),name:s,type:i,onChange:t=>!u&&a(t),..."checkbox"===i?{checked:v}:{value:n},...r&&{autoComplete:r},...e&&{placeholder:e}})]})}}}]);
//# sourceMappingURL=117.fb4ba3c0.chunk.js.map